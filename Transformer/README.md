# Transformer Model for Question-Answer Dataset from Harry Potter and the Sorcerer's Stone

This repository contains code for training and evaluating a Transformer model on a question-answer dataset derived from Harry Potter and the Sorcerer's Stone. The project demonstrates how to preprocess text data, train a Transformer model, and evaluate its performance.

## Overview
The project involves:
* Data Processing: Cleaning question-answer pairs.
* Model Training: Training a Transformer model on the processed data.
* Evaluation: Testing the trained model with sample questions and custom queries.

## Project Structure
	* train_and_eval.py: The main script for training and evaluating the Transformer model.
	* data_tokenized/: Directory to store tokenized data (question/answer)
	* checkpoints/: Directory for saving model checkpoints.



## Dependencies
Make sure you have the following packages installed:
* tensorflow numpy pandas scikit-learn sentencepiece contractions



## Data Processing: question/answer generation
* The dataset used consists of question-answer pairs from Harry Potter and the Sorcerer's Stone. For data processing details, refer to the **[Text_Processing](../Text_Processing)** folder's README 


## Usage
* Training
	-  To train the model, set the `choice` variable to `'train'` in the `train_and_eval.py` script:
		```python
		if __name__ == "__main__":
		    choice = 'train'
		    # (Training code here)
  		```
	- Ensure the path to your question-answer dataset is correctly specified in the path_aq variable. The dataset will be processed and saved as data_tokenized/data_token.pickle.
The training loop will save model weights to final_weights.h5 and periodically save checkpoints to ./checkpoints.

* Evaluation
	-  To evaluate the model, set the `choice` variable to `'eval'` in the `train_and_eval.py` script:
		```python
		if __name__ == "__main__":
		    choice = 'eval'
		    # (Evaluation code here)
  		```
	- The script will load the tokenized data and model weights, run evaluations, and print predictions for sample and custom questions.


## Example Output
- **Input:**  
  The original question or prompt provided to the model.

- **Predicted:**  
  The response generated by the model based on the input.

- **Actual:**  
  The correct or expected response for the given input.

Test Case 5881
* Input      : what was the reaction of the students when they first caught sight of hogwarts
* Predicted  : The text describes a scene in which a large group of people is gathered together to learn. One student named Neville is feeling overwhelmed with emotion as he approaches. A voice announces that they will be arriving at Hogwarts in five minutes. The train slows down, and they quickly exit, only to hear their conversation.
* Actual     : The group was traveling through a dense forest, with trees so thick that Harry assumed it must be difficult to navigate. The journey was mostly quiet, with the exception of Neville, who had a habit of losing his pet toad and occasionally sniffed. Hagrid, the guide, informed them that they were about to see Hogwarts soon, and there was a collective gasp of excitement from the group
-----------------
Test Case Custom
* Input      : describe hagrid
* Predicted  : Hagrid is a character in the Harry Potter series who is known for his love and knowledge of the wizarding world. In this passage, he is speaking to a young boy who is likely a student at Hogwarts and considers his loyalty to Dumbledore. In this passage, Hagrid is shown to be familiar with the wizarding world and its creatures, as he offers to give them a ride to Kingâ€™s Cross Station. The passage also mentions that Hagrid is familiar with Hogwarts, and its size suggests that Hagrid is friendly and welcoming, willing to take risks with new things.
* Actual : Hagrid is the half-giant Keeper of Keys and Grounds at Hogwarts, loyal to Dumbledore, and a friend to Harry.
----------------------------------------

## Comments
In this project, I have demonstrated that the Transformer model is capable of generating meaningful and coherent responses even with a relatively small dataset. However, it is important to note that the responses are not perfect. 


The performance of the model can be significantly enhanced by incorporating additional data. Expanding the dataset to include text from other Harry Potter books, as well as supplementary information from external sources, will likely improve the model's accuracy and overall effectiveness.


## Authors

* Enrico Boscolo
