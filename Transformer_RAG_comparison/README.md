# Comparative Study of Question-Answering Approaches: RAG vs. Transformer Models from scratch on Harry Potter (book 1)

This project presents  a comparative study based on Harry Potter and the Sorcerer's Stone using my implementation of a Transformer model from scratch, and a Retrieval-Augmented Generation (RAG) approach. The goal is to evaluate how each method performs in answering specific questions.

## Overview
The project involves:
-  Data Processing: Cleaning text.
-  RAG Implementation: Setting up a basic Retrieval-Augmented Generation pipeline to generate answers based on retrieved information.
-  Transformer Model Loading: Loading a pre-trained Transformer model that has been trained on the processed data.
-  Comparison: Evaluating and comparing the performance of both models in answering specific questions.


## Dependencies
Make sure you have the following packages installed:
- OpenAI, LangChain, TensorFlow, pickle, re, sys
 
Importing Transformer Class
- The Transformer class is imported from the TransformerModel.py script, which is located in the **[Transformer](../Transformer)**  folder within this repository.


## Usage
- RAG pipeline setting and test
     - Set choice variable to 'rag' to start the RAG pipeline, which tests the OpenAI connection, loads and cleans the text from harry1.txt, and splits it into chunks. It creates a vector store for efficient retrieval, generates answers to questions, and saves the processed data for future use. Finally, it prints the generated answer and the relevant source document.
  
	```python
	if __name__ == "__main__":
 		choice = 'rag'
 		# (starting code here)
 	```

- Comparison Transformer vs RAG
	- To start the comparison, set the choice variable to 'comparison':

	```python
	if __name__ == "__main__":
		choice = 'comparison'
		# (Comparison code here)
	```

## Some Results
- **Input:**  
  The original question provided to the model.

- **Predicted Transformer:**  
  The response generated by the model based on the input.

- **Predicted RAG:**  
  The response generated by RAG pipeline

-----------------
Test 1
* Input      : How does Harry Potter initially discover that he is a wizard in Harry Potter and the Sorcerer's Stone, and what role does Hagrid play in this revelation?
* Transformer Predicted  : Harry Potter initially discovers that he is a wizard and has been accepted to Hogwarts School of Witchcraft and Wizardry. Hagrid plays a crucial role in this revelation by revealing his true identity as a wizard and informing him about his magical background.
* RAG Predicted : Harry discovers that he is a wizard when Hagrid tells him on the night they met. Hagrid plays a crucial role by revealing Harry's true identity and introducing him to the wizarding world.
----------------------------------------
Test 2
* Input                 : What is the name of the dark wizard who tried to kill Harry as a baby?
* Transformer Predicted : Voldemort.
* RAG Predicted         :  The dark wizard's name is Voldemort.
----------------------------------------
Test 3
* Input                 : What is the significance of the Sorting Hat ceremony at Hogwarts?
* Transformer Predicted : The Sorting Hat ceremony at Hogwarts is a magical Sorting Hat that determines which of the four houses each student will be sorted into.
* RAG Predicted         :  The Sorting Hat ceremony is a significant event at Hogwarts where new students are sorted into one of the four houses and sets the tone for their Hogwarts experience.
----------------------------------------
Test 4
* Input                 : Who is the headmaster of Hogwarts during Harry's first year?
* Transformer Predicted : Albus Dumbledore.
* RAG Predicted         : Professor Dumbledore is the headmaster of Hogwarts during Harry's first year.
----------------------------------------

## Comments
With the questions used, both the Transformer model and the RAG pipeline provide satisfactory and compatible answers


## Authors

* Enrico Boscolo
